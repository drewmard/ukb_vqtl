g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_manual(values=c('black',,'orange'))
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col < 1e-5] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_color_continuous(low='black',high='steelblue')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_manual(values=c('black',,'orange'))
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col < 1e-5] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
table(df.mg.sub$var.raw_col)
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col < 5e-8] <- 10
table(df.mg.sub)
table(df.mg.sub$var.raw_col)
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col > -log10(5e-8)] <- 10
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_color_continuous(low='black',high='steelblue')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_manual(values=c('black',,'orange'))
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col < 1e-5] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_color_continuous(low='grey84',high='steelblue')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_manual(values=c('black',,'orange'))
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col < 1e-5] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_color_continuous(low='grey84',high='steelblue')
g1
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_color_continuous(low='tomato2',high='steelblue')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_manual(values=c('black',,'orange'))
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col < 1e-5] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='black',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_color_continuous(low='tomato2',high='steelblue')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_manual(values=c('black',,'orange'))
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col < 1e-5] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_continuous(low='tomato2',high='steelblue')
g1
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col > -log10(5e-8)] <- 10
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_continuous(low='tomato2',high='steelblue')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_manual(values=c('black',,'orange'))
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col < 1e-5] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col > -log10(5e-8)] <- 10
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_continuous(low='tomato2',high='steelblue')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_manual(values=c('black',,'orange'))
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col < 1e-5] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2 #+ scale_color_continuous(low='tomato2',high='steelblue')
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2() #+ scale_color_continuous(low='tomato2',high='steelblue')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_manual(values=c('black',,'orange'))
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col < 1e-5] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
?scale_color_gradient2
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='black') #+ scale_color_continuous(low='tomato2',high='steelblue')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_manual(values=c('black',,'orange'))
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col < 1e-5] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83') #+ scale_color_continuous(low='tomato2',high='steelblue')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') #+ scale_color_manual(values=c('black',,'orange'))
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col < 1e-5] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col < 1e-5] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col > -log10(5e-8)] <- 10
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col > -log10(1e-5)] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col > -log10(5e-8)] <- 10
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col > -log10(1e-5)] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muqTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=350)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=400)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col > -log10(5e-8)] <- 10
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col > -log10(1e-5)] <- 10
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=450)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col > -log10(5e-8)] <- 15
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col > -log10(1e-5)] <- 15
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000,height=1500,res=450)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
x=2
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000*x,height=1500*x,res=450*x)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
x=3
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000*x,height=1500*x,res=450*x)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col > -log10(5e-8)] <- 15
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point(size=rel(0.6)) + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col > -log10(1e-5)] <- 15
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
x=2
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000*x,height=1500*x,res=450*x)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col > -log10(5e-8)] <- 15
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point(size=rel(0.6)) + geom_smooth(col='red',method='lm',se=F) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point(size=rel(0.6)) + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col > -log10(1e-5)] <- 15
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point(size=rel(0.6)) + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
x=2
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000*x,height=1500*x,res=450*x)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col > -log10(5e-8)] <- 15
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point(size=rel(0.6)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.4)) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point(size=rel(0.6)) + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col > -log10(1e-5)] <- 15
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point(size=rel(0.6)) + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 muQTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
x=2
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000*x,height=1500*x,res=450*x)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col > -log10(5e-8)] <- 15
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point(size=rel(0.6)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point(size=rel(0.6)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col > -log10(1e-5)] <- 15
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point(size=rel(0.6)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='-log10 muQTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
x=2
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000*x,height=1500*x,res=450*x)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col > -log10(5e-8)] <- 15
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col > -log10(1e-5)] <- 15
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='-log10 muQTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
x=2
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000*x,height=1500*x,res=450*x)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
df.mg.sub <- subset(df.mg,MAF > 0.05)
# g1 <- ggplot(df.mg.sub,aes(x=BETA.x,y=BETA.y)) + geom_point() + geom_smooth(col='red',method='lm') + labs(x='Mean effects',y='Variance effects')
# g2 <- ggplot(df.mg.sub,aes(x=-log10(P.x),y=-log10(P.y))) + geom_point() + geom_smooth(col='red',method='lm') + labs(x='Mean pval',y='Variance pval')
df.mg.sub$var.raw_col <- floor(-log10(df.mg.sub$P.VAR.RAW))
df.mg.sub$var.raw_col[df.mg.sub$var.raw_col > -log10(5e-8)] <- 15
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.raw_col))) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
df.mg.sub$var.rint_col <- floor(-log10(df.mg.sub$P.VAR.RINT))
df.mg.sub$var.rint_col[df.mg.sub$var.rint_col > -log10(1e-5)] <- 15
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT),col=(var.rint_col))) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='-log10 muQTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
x=2
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL.png',width=5000*x,height=1500*x,res=450*x)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
source('~/Documents/Research/vQTL/ukb_vqtl/scripts/FINAL/gwas/mean_vs_var_plots.R')
head(df.mg)
head(df.mg.sub)
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW,col=var.rint_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='muQTL effects',y='Raw vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RINT,col=var.rint_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='muQTL effects',y='RINT vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g3 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW),col=(var.rint_col))) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='-log10 muQTL p-values',y='-log10 raw vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
x=2
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL_2.png',width=5000*x,height=1500*x,res=450*x)
plot_grid(g1,g2,g3,nrow=1)
dev.off()
df.mg.sub$mean.raw_col <- floor(-log10(df.mg.sub$P.MEAN))
df.mg.sub$mean.raw_col[df.mg.sub$P.MEAN > -log10(5e-8)] <- 15
g1 <- ggplot(df.mg.sub[1:10000,],aes(x=BETA.VAR.RAW,y=BETA.VAR.RINT,col=mean.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='Raw variance effects',y='RINT variance effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub[1:10000,],aes(x=-log10(P.VAR.RAW),y=-log10(P.VAR.RINT),col=mean.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='-log10 raw variance p-values',y='-log10 RINT variance p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g3 <- ggplot(df.mg.sub[1:10000,],aes(x=BETA.MEAN,y=BETA.MEAN.RINT,col=mean.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Raw variance effects',y='RINT variance effects')
g4 <- ggplot(df.mg.sub[1:10000,],aes(x=-log10(P.MEAN),y=-log10(P.MEAN.RINT),col=mean.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 raw variance p-values',y='-log10 RINT variance p-values')
df.mg.sub$mean.raw_col <- floor(-log10(df.mg.sub$P.MEAN))
df.mg.sub$mean.raw_col[df.mg.sub$P.MEAN > -log10(5e-8)] <- 15
g1 <- ggplot(df.mg.sub[1:10000,],aes(x=BETA.VAR.RAW,y=BETA.VAR.RINT,col=mean.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='Raw variance effects',y='RINT variance effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub[1:10000,],aes(x=-log10(P.VAR.RAW),y=-log10(P.VAR.RINT),col=mean.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='-log10 raw variance p-values',y='-log10 RINT variance p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g3 <- ggplot(df.mg.sub[1:10000,],aes(x=BETA.MEAN,y=BETA.MEAN.RINT,col=mean.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Raw variance effects',y='RINT variance effects')
g4 <- ggplot(df.mg.sub[1:10000,],aes(x=-log10(P.MEAN),y=-log10(P.MEAN.RINT),col=mean.raw_col)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 raw variance p-values',y='-log10 RINT variance p-values')
x=2
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL_3.png',width=3000*x,height=3000*x,res=450*x)
plot_grid(g1,g2,g3,g4,nrow=2)
dev.off()
df.mg.sub$mean.raw_col <- floor(-log10(df.mg.sub$P.MEAN))
df.mg.sub$mean.raw_col[df.mg.sub$P.MEAN > -log10(5e-8)] <- 15
g1 <- ggplot(df.mg.sub[1:10000,],aes(x=BETA.VAR.RAW,y=BETA.VAR.RINT,col=mean.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='Raw vQTL effects',y='RINT vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub[1:10000,],aes(x=-log10(P.VAR.RAW),y=-log10(P.VAR.RINT),col=mean.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='-log10 raw vQTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g3 <- ggplot(df.mg.sub[1:10000,],aes(x=BETA.MEAN,y=BETA.MEAN.RINT,col=mean.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) +labs(x='Raw muQTL effects',y='RINT muQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g4 <- ggplot(df.mg.sub[1:10000,],aes(x=-log10(P.MEAN),y=-log10(P.MEAN.RINT),col=mean.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) +  labs(x='-log10 raw muQTL p-values',y='-log10 RINT muQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
x=2
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL_3.png',width=3000*x,height=3000*x,res=450*x)
plot_grid(g1,g2,g3,g4,nrow=2)
dev.off()
head(df.mg.sub)
df.mg.sub$mean.raw_col <- floor(-log10(df.mg.sub$P.MEAN))
df.mg.sub$mean.raw_col[df.mg.sub$P.MEAN > -log10(5e-8)] <- 15
g1 <- ggplot(df.mg.sub,aes(x=BETA.VAR.RAW,y=BETA.VAR.RINT,col=mean.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='Raw vQTL effects',y='RINT vQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.VAR.RAW),y=-log10(P.VAR.RINT),col=mean.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) + labs(x='-log10 raw vQTL p-values',y='-log10 RINT vQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g3 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.MEAN.RINT,col=var.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) +labs(x='Raw muQTL effects',y='RINT muQTL effects') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
g4 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.MEAN.RINT),col=var.raw_col)) + geom_point(size=rel(0.75)) + geom_smooth(col='red',method='lm',se=F,size=rel(0.6)) +  labs(x='-log10 raw muQTL p-values',y='-log10 RINT muQTL p-values') + theme_bw() + theme(panel.grid=element_blank(),legend.position = 'none') + scale_colour_gradient2(mid='grey83')
x=2
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var_PANEL_3.png',width=3000*x,height=3000*x,res=450*x)
plot_grid(g1,g2,g3,g4,nrow=2)
dev.off()
f<-'/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.ALL_RESULTS.trim.txt'
df <- fread(f,data.table = F,stringsAsFactors = F)
library(data.table)
f<-'/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.ALL_RESULTS.trim.txt'
df <- fread(f,data.table = F,stringsAsFactors = F)
head(df)
dim(df)
colnames(df)[4] <- 'P_GxE'
library(data.table)
f<-'/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.ALL_RESULTS.trim.txt'
df <- fread(f,data.table = F,stringsAsFactors = F)
colnames(df)[4] <- 'P_GxE'
library(data.table)
f<-'/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.ALL_RESULTS.trim.txt'
df <- fread(f,data.table = F,stringsAsFactors = F)
colnames(df)[4] <- 'P_GxE'
results.mg$FDR <- p.adjust(results.mg[,4],method = 'fdr')
library(data.table)
f<-'/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.ALL_RESULTS.trim.txt'
df <- fread(f,data.table = F,stringsAsFactors = F)
colnames(df)[4] <- 'P_GxE'
df$FDR <- p.adjust(df[,4],method = 'fdr')
dim(df)
df <- subset(df,FDR < 0.1)
nrow(df)
library(data.table)
f<-'/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.ALL_RESULTS.trim.txt'
df <- fread(f,data.table = F,stringsAsFactors = F)
colnames(df)[4] <- 'P_GxE'
df$FDR <- p.adjust(df[,4],method = 'fdr')
df <- subset(df,FDR <= 0.1)
dim(df)
library(data.table)
f<-'/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.ALL_RESULTS.trim.txt'
df <- fread(f,data.table = F,stringsAsFactors = F)
colnames(df)[4] <- 'P_GxE'
df$FDR <- p.adjust(df[,4],method = 'fdr')
df$Sig <- 0
library(data.table)
f<-'/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.ALL_RESULTS.trim.txt'
df <- fread(f,data.table = F,stringsAsFactors = F)
colnames(df)[4] <- 'P_GxE'
df$FDR <- p.adjust(df$P_GxE,method = 'fdr')
df$Sig <- 0
head(df)
library(data.table)
f<-'/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.ALL_RESULTS.trim.txt'
df <- fread(f,data.table = F,stringsAsFactors = F)
colnames(df)[4] <- 'P_GxE'
df$FDR <- p.adjust(df$P_GxE,method = 'fdr')
df$Sig <- 0
df$Sig[df$FDR < 0.1] <- 1
df$Sig[df$FDR < 0.05] <- 2
df$Sig[df$FDR < 0.01] <- 3
head(df)
df <- subset(df,SNP %in% subset(df,Sig > 0)$SNP)
ggplot(df,aes(x=SNP,y=E,fill=Sig)) +
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
# midpoint = 0, limit = c(min(df.sub.melt$value),max(df.sub.melt$value)), space = "Lab",
name="Mean\nAbundance") +
theme_minimal()+ # minimal theme
coord_fixed() +
theme(
# axis.text.x = element_blank(),
axis.text.x = element_text(angle = 40, #vjust = 1,
#                            size = rel(0.85), hjust = 1),
# axis.text.y = element_text(size = rel(0.85)),
size = rel(1), hjust = 1),
axis.text.y = element_text(size = rel(1)),
plot.title = element_text(hjust=0.5),panel.grid = element_blank(),
legend.position = 'none')  +
labs(x='SNP',y='Environmental Factor')
thres=0.05; suff <- ifelse(is.null(thres),'','PVAL.')
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.validation.summary.full.',suff,'txt')
df.save <- fread(f,data.table = F,stringsAsFactors = F)
df.save$FDR_based <- 1; df.save$FDR_based[df.save$thres %in% c(1,0.1,0.05,0.01,0.005,0.001)] <- 0
g3<-ggplot(subset(df.save,thres <= 0.05),aes(x=-log10(thres),y=p)) + geom_line() + geom_point(aes(col=as.factor(FDR_based))) + theme_bw() +
labs(title='') + scale_color_manual(values=c('black','red')) +
geom_ribbon(aes(ymin=lower,ymax=upper),linetype=2,alpha=0.1) + ylim(0,1) + geom_hline(yintercept=ifelse(is.null(thres),0.5,df.matched$p[df.matched$thres==0.05]),linetype='dashed',col='red') +
theme(axis.title=element_blank(),panel.grid = element_blank(),legend.position = 'none') + scale_x_continuous(breaks = c(2,3,4,5))
library(data.table)
library(ggplot2)
library(cowplot)
thres=0.05; suff <- ifelse(is.null(thres),'','PVAL.')
thres=NULL; suff <- ifelse(is.null(thres),'','PVAL.')
library(data.table)
library(ggplot2)
library(cowplot)
thres=0.05; suff <- ifelse(is.null(thres),'','PVAL.')
# thres=NULL; suff <- ifelse(is.null(thres),'','PVAL.')
thres=0.05; suff <- ifelse(is.null(thres),'','PVAL.')
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.validation.summary.full.',suff,'txt')
df.save <- fread(f,data.table = F,stringsAsFactors = F)
df.save$FDR_based <- 1; df.save$FDR_based[df.save$thres %in% c(1,0.1,0.05,0.01,0.005,0.001)] <- 0
g3<-ggplot(subset(df.save,thres <= 0.05),aes(x=-log10(thres),y=p)) + geom_line() + geom_point(aes(col=as.factor(FDR_based))) + theme_bw() +
labs(title='') + scale_color_manual(values=c('black','red')) +
geom_ribbon(aes(ymin=lower,ymax=upper),linetype=2,alpha=0.1) + ylim(0,1) + geom_hline(yintercept=ifelse(is.null(thres),0.5,df.matched$p[df.matched$thres==0.05]),linetype='dashed',col='red') +
theme(axis.title=element_blank(),panel.grid = element_blank(),legend.position = 'none') + scale_x_continuous(breaks = c(2,3,4,5))
thres=0.05; suff <- ifelse(is.null(thres),'','PVAL.')
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.validation.summary.full.',suff,'txt')
df.save <- fread(f,data.table = F,stringsAsFactors = F)
df.save$FDR_based <- 1; df.save$FDR_based[df.save$thres %in% c(1,0.1,0.05,0.01,0.005,0.001)] <- 0
df.save
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.validation.summary.only_mean.',suff,'txt')
df.only_mean <- fread(f,data.table = F,stringsAsFactors = F);
df.only_mean$FDR_based <- 1; df.only_mean$FDR_based[df.only_mean$thres %in% c(1,0.1,0.05,0.01,0.005,0.001)] <- 0
g5<-ggplot(subset(df.only_mean,thres <=0.05),aes(x=-log10(thres),y=p)) + geom_line() + geom_point(aes(col=as.factor(FDR_based))) + theme_bw() +
labs(title='') + scale_color_manual(values=c('black','red')) +
geom_ribbon(aes(ymin=lower,ymax=upper),linetype=2,alpha=0.1) + ylim(0,1) + geom_hline(yintercept=ifelse(is.null(thres),0.5,0.025),linetype='dashed',col='red') +
theme(axis.title=element_blank(),panel.grid = element_blank(),legend.position = 'none')
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.validation.summary.var_raw.',suff,'txt')
df.var_raw <- fread(f,data.table = F,stringsAsFactors = F);
df.var_raw$FDR_based <- 1; df.var_raw$FDR_based[df.var_raw$thres %in% c(1,0.1,0.05,0.01,0.005,0.001)] <- 0
g7<-ggplot(subset(df.var_raw,thres <= 0.05),aes(x=-log10(thres),y=p)) + geom_line() + geom_point(aes(col=as.factor(FDR_based))) + theme_bw() +
labs(title='') + scale_color_manual(values=c('black','red')) +
geom_ribbon(aes(ymin=lower,ymax=upper),linetype=2,alpha=0.1) + ylim(0,1) + geom_hline(yintercept=ifelse(is.null(thres),0.5,0.025),linetype='dashed',col='red') +
theme(axis.title=element_blank(),panel.grid = element_blank(),legend.position = 'none')
g5
df.only_mean
df.var_raw
THRESHOLD=0.05
binom.test(
prod(df.var_raw[df.var_raw$thres==THRESHOLD,c('p','N')]),
df.var_raw[df.var_raw$thres==THRESHOLD,c('N')],
df.only_mean$p[df.only_mean$thres==THRESHOLD]
)
df.var_raw$p[df.var_raw$thres==THRESHOLD]/df.only_mean$p[df.only_mean$thres==THRESHOLD]
THRESHOLD=0.001
binom.test(
prod(df.var_raw[df.var_raw$thres==THRESHOLD,c('p','N')]),
df.var_raw[df.var_raw$thres==THRESHOLD,c('N')],
df.only_mean$p[df.only_mean$thres==THRESHOLD]
)
df.var_raw$p[df.var_raw$thres==THRESHOLD]/df.only_mean$p[df.only_mean$thres==THRESHOLD]
df.only_mean$p[df.only_mean$thres==THRESHOLD]
df.only_mean
26.8/8
34.6/10.8
40/14.3
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.validation.summary.mean.var_raw_matched_mean.',suff,'txt')
df.mean.var_raw_matched_mean <- fread(f,data.table = F,stringsAsFactors = F);
df.mean.var_raw_matched_mean$FDR_based <- 1; df.mean.var_raw_matched_mean$FDR_based[df.mean.var_raw_matched_mean$thres %in% c(1,0.1,0.05,0.01,0.005,0.001)] <- 0
df.mean.var_raw_matched_mean
exp(-0.07)
library(data.table)
library(ggplot2)
library(cowplot)
library(reshape2)
# parameters
MAF1 <- 0.4
# MAF1 <- 0.1
MAF2 <- 0.4
nsim <- 1000;
nindiv <- 10000
simulation_type='gxg'
genetic_variance_explained.vec <- seq(0.01,0.1,by=0.01);
simulation_type <- 'gxg'
phenotype_noise <- 'NORMAL'
dir='/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f=paste0(dir,'MAF1_',MAF1,'.MAF2_',MAF2,'.NSIM_',nsim,'.NINDIV_',nindiv,'.TYPE_',simulation_type,'.NOISE_',phenotype_noise,'.txt')
df1 <- fread(f,data.table = F,stringsAsFactors = F)
phenotype_noise <- 'CHISQ4'
dir='/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f=paste0(dir,'MAF1_',MAF1,'.MAF2_',MAF2,'.NSIM_',nsim,'.NINDIV_',nindiv,'.TYPE_',simulation_type,'.NOISE_',phenotype_noise,'.txt')
df2 <- fread(f,data.table = F,stringsAsFactors = F)
df.mg <- rbind(df1,df2)
simulation_type <- 'mean'
phenotype_noise <- 'NORMAL'
dir='/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f=paste0(dir,'MAF1_',MAF1,'.MAF2_',MAF2,'.NSIM_',nsim,'.NINDIV_',nindiv,'.TYPE_',simulation_type,'.NOISE_',phenotype_noise,'.txt')
df1 <- fread(f,data.table = F,stringsAsFactors = F)
df.mg <- rbind(df.mg,df1)
phenotype_noise <- 'CHISQ4'
dir='/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f=paste0(dir,'MAF1_',MAF1,'.MAF2_',MAF2,'.NSIM_',nsim,'.NINDIV_',nindiv,'.TYPE_',simulation_type,'.NOISE_',phenotype_noise,'.txt')
df2 <- fread(f,data.table = F,stringsAsFactors = F)
df.mg <- rbind(df.mg,df2)
rm(df1);rm(df2)
# ggplot(df.mg,aes(x=as.factor(h),y=beta,fill=noise)) + geom_boxplot(alpha=0.5) + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y=expression(beta['var']))# +
gA <- ggplot(subset(df.mg,noise=='NORMAL' & type=='gxg'),aes(x=as.factor(h),y=beta,fill=h)) + geom_boxplot(alpha=0.5) + theme_bw() + theme(panel.grid = element_blank(),legend.position = 'none') + labs(x='Variance explained by simulated GxG',y=expression(beta['var'])) +
scale_fill_continuous(low='yellow',high='red')
gB <- ggplot(subset(df.mg,noise=='NORMAL' & type=='mean'),aes(x=as.factor(h),y=beta,fill=h)) + geom_boxplot(alpha=0.5) + theme_bw() + theme(panel.grid = element_blank(),legend.position = 'none') + labs(x='Variance explained by simulated mean QTL',y=expression(beta['var'])) +
scale_fill_continuous(low='yellow',high='red')
gA
cor(subset(df.mg,noise=='NORMAL' & type=='gxg')[,c('h','beta')])
df.aggre <- aggregate(.~MAF1+MAF2+N+noise+h+type,df.mg[,-c(7)],function(x) {mean(x < 0.05)})
df.aggre.melt <- melt(df.aggre[,c(4:ncol(df.aggre))],id.vars=c('h','noise','type'))
g2 <- ggplot(subset(df.aggre.melt,noise=='NORMAL' & type=='gxg'),aes(x=h,y=value,col=variable)) + geom_line() + geom_point() + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y='Power') + scale_color_brewer(palette='Dark2') + theme(legend.title = element_blank())
g3 <- ggplot(subset(df.aggre.melt,noise=='CHISQ4' & type=='gxg'),aes(x=h,y=value,col=variable)) + geom_line() + geom_point() + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y='Power') + scale_color_brewer(palette='Dark2') + theme(legend.title = element_blank())
g4 <- ggplot(subset(df.aggre.melt,noise=='NORMAL' & type=='mean'),aes(x=h,y=value,col=variable)) + geom_line() + geom_point() + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by mean QTL',y='False Positive Rate') + geom_abline(slope=0,intercept=0.05,col='red',linetype='dashed') + scale_color_brewer(palette='Dark2') + theme(legend.title = element_blank())
g5 <- ggplot(subset(df.aggre.melt,noise=='CHISQ4' & type=='mean'),aes(x=h,y=value,col=variable)) + geom_line() + geom_point() + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by mean QTL',y='False Positive Rate') + geom_abline(slope=0,intercept=0.05,col='red',linetype='dashed') + scale_color_brewer(palette='Dark2')+ theme(legend.title = element_blank())
plot_grid(g2,g3,g4,g5,ncol=2)
aggregate(.~MAF1+MAF2+N+noise+type,df.mg[,-c(7)],function(x) {mean(x < 0.05)})
g2 <- ggplot(subset(df.aggre.melt,noise=='NORMAL' & type=='gxg' & variable%in%c('LT','DRM')),aes(x=h,y=value,col=variable)) + geom_line() + geom_point() + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y='Power') + scale_color_brewer(palette='Dark2')+ theme(legend.title = element_blank())
g3 <- ggplot(subset(df.aggre.melt,noise=='CHISQ4' & type=='gxg' & variable%in%c('LT','DRM')),aes(x=h,y=value,col=variable)) + geom_line() + geom_point() + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y='Power') + scale_color_brewer(palette='Dark2')+ theme(legend.title = element_blank())
plot_grid(g2,g3,ncol=2)
g2 <- ggplot(subset(df.aggre.melt,noise=='NORMAL' & type=='gxg' & variable%in%c('LT','DRM')),aes(x=h,y=value,col=variable)) + geom_line() + geom_point(size=rel(0.8)) + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y='Power') + scale_color_brewer(palette='Dark2')+ theme(legend.title = element_blank())
g2
g2 <- ggplot(subset(df.aggre.melt,noise=='NORMAL' & type=='gxg' & variable%in%c('LT','DRM')),aes(x=h,y=value,col=variable)) + geom_line() + geom_point(size=rel(0.8)) + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y='Power') + scale_color_brewer(palette='Dark2')+ theme(legend.title = element_blank())
g3 <- ggplot(subset(df.aggre.melt,noise=='CHISQ4' & type=='gxg' & variable%in%c('LT','DRM')),aes(x=h,y=value,col=variable)) + geom_line() + geom_point(size=rel(0.8)) + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y='Power') + scale_color_brewer(palette='Dark2')+ theme(legend.title = element_blank())
f='~/Documents/Research/vQTL/ukb_vqtl/output/simulation/power_fpr_plots2.png'
png(f,width=3750,height=1000,res=500)
plot_grid(g2,g3,ncol=2)
dev.off()
g2 <- ggplot(subset(df.aggre.melt,noise=='NORMAL' & type=='gxg' & variable%in%c('LT','DRM')),aes(x=h,y=value,col=variable)) + geom_line() + geom_point(size=rel(0.8)) + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y='Power') + scale_color_brewer(palette='Dark2')+ theme(legend.title = element_blank())
g3 <- ggplot(subset(df.aggre.melt,noise=='CHISQ4' & type=='gxg' & variable%in%c('LT','DRM')),aes(x=h,y=value,col=variable)) + geom_line() + geom_point(size=rel(0.8)) + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y='Power') + scale_color_brewer(palette='Dark2')+ theme(legend.title = element_blank())
f='~/Documents/Research/vQTL/ukb_vqtl/output/simulation/power_fpr_plots2.png'
png(f,width=3750,height=1000,res=500)
plot_grid(g2,g3,ncol=1)
dev.off()
g2 <- ggplot(subset(df.aggre.melt,noise=='NORMAL' & type=='gxg' & variable%in%c('LT','DRM')),aes(x=h,y=value,col=variable)) + geom_line() + geom_point(size=rel(0.8)) + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y='Power') + scale_color_brewer(palette='Dark2')+ theme(legend.title = element_blank())
g3 <- ggplot(subset(df.aggre.melt,noise=='CHISQ4' & type=='gxg' & variable%in%c('LT','DRM')),aes(x=h,y=value,col=variable)) + geom_line() + geom_point(size=rel(0.8)) + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y='Power') + scale_color_brewer(palette='Dark2')+ theme(legend.title = element_blank())
f='~/Documents/Research/vQTL/ukb_vqtl/output/simulation/power_fpr_plots2.png'
# png(f,width=3750,height=1000,res=500)
# plot_grid(g2,g3,nrow=1)
png(f,width=1500,height=4000,res=500)
plot_grid(g2,g3,ncol=1)
dev.off()
g2 <- ggplot(subset(df.aggre.melt,noise=='NORMAL' & type=='gxg' & variable%in%c('LT','DRM')),aes(x=h,y=value,col=variable)) + geom_line() + geom_point(size=rel(0.8)) + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y='Power') + scale_color_brewer(palette='Dark2')+ theme(legend.title = element_blank())
g3 <- ggplot(subset(df.aggre.melt,noise=='CHISQ4' & type=='gxg' & variable%in%c('LT','DRM')),aes(x=h,y=value,col=variable)) + geom_line() + geom_point(size=rel(0.8)) + theme_bw() + theme(panel.grid = element_blank()) + labs(x='Variance Explained by GxG',y='Power') + scale_color_brewer(palette='Dark2')+ theme(legend.title = element_blank())
f='~/Documents/Research/vQTL/ukb_vqtl/output/simulation/power_fpr_plots2.png'
# png(f,width=3750,height=1000,res=500)
# plot_grid(g2,g3,nrow=1)
png(f,width=4000,height=4000,res=500)
plot_grid(g2,g3,ncol=1)
dev.off()
# png(f,width=3750,height=1000,res=500)
# plot_grid(g2,g3,nrow=1)
png(f,width=2500,height=2500,res=500)
plot_grid(g2,g3,ncol=1)
dev.off()

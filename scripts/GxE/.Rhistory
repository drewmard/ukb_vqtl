?apply
?procmp
?prcomp
head(res)
source('~/Documents/Research/vQTL/ukb_vqtl/bin/rntransform.R')
source('~/Documents/Research/vQTL/ukb_vqtl/bin/rntransform.R')
BETA <- as.matrix(coef(mod)[paste0('DIET_PC',1:20)])
library(BEDMatrix)
?BEDMatrix
library(data.table)
head(pca)
library(data.table)
source('~/Documents/Research/vQTL/ukb_vqtl/scripts/GxE/gen_envir_factors.R')
source('~/Documents/Research/vQTL/ukb_vqtl/scripts/GxE/gen_envir_factors.R')
View(rntransform)
colnames(geno)
thres <- seq(0,8,by=0.1)
thres
environmental_factors <- c('SB',
'PA',
'Smoking.E',
'age',
'sex',
paste0('DIET_PC',1:10),
c('Cooked vegetable intake',
'Salad / raw vegetable intake',
'Fresh fruit intake',
'Dried fruit intake',
'Bread intake',
'Cereal intake',
'Tea intake',
'Coffee intake',
'Water intake',
'Oily fish intake',
'Non-oily fish intake',
'Processed meat intake',
'Poultry intake',
'Beef intake',
'Lamb/mutton intake',
'Pork intake',
'Cheese intake',
'Salt added to food',
'Variation in diet',
'Alcohol intake frequency'
))
environmental_factors
c('IID',environmental_factors)
gsub(" |/",'_',c('IID',environmental_factors))
gsub(" |/",'_',c('IID',environmental_factors))
environmental_factors <- c('SB',
'PA',
'Smoking.E',
'age',
'sex',
paste0('DIET_PC',1:10),
c('Cooked vegetable intake',
'Salad / raw vegetable intake',
'Fresh fruit intake',
'Dried fruit intake',
'Bread intake',
'Cereal intake',
'Tea intake',
'Coffee intake',
'Water intake',
'Oily fish intake',
'Non-oily fish intake',
'Processed meat intake',
'Poultry intake',
'Beef intake',
'Lamb/mutton intake',
'Pork intake',
'Cheese intake',
'Salt added to food',
'Variation in diet',
'Alcohol intake frequency',
c('produce_intake','veggie_intake','fruit_intake','tea_coffee_intake','fish_intake','meat_intake','red_meat_intake','fish_meat_intake')
))
library(ggplot2)
library(data.table)
library(pheatmap)
library(matrixStats)
library(cowplot)
k=7; i=k
df <- fread('~/Documents/Research/GTEx/Infiltration/GTEx_infil/output/infiltration_phenotypes.txt',data.table = F,stringsAsFactors = F)
df <- fread('/Users/andrewmarderstein/Documents/Research/GTEx/Infiltration/GTEx_infil/output/HotCold_Cluster/FullHotColdAssignments_Correct.txt',data.table = F,stringsAsFactors = F)
head(df)
unique(df$Infiltration)
library(ggplot2)
library(data.table)
library(pheatmap)
library(matrixStats)
library(cowplot)
k=7; i=k
df <- fread('~/Documents/Research/GTEx/Infiltration/GTEx_infil/output/infiltration_phenotypes.txt',data.table = F,stringsAsFactors = F)
df <- fread('/Users/andrewmarderstein/Documents/Research/GTEx/Infiltration/GTEx_infil/output/HotCold_Cluster/FullHotColdAssignments_Correct.txt',data.table = F,stringsAsFactors = F)
df <- fread('/Users/andrewmarderstein/Documents/Research/GTEx/Infiltration/GTEx_infil/output/HotCold_Cluster/ConsensusQuintileAssignments-FullSecond.txt',data.table = F,stringsAsFactors = F); colnames(df)[which(colnames(df)=='ID')] <- 'IID'
unique(df$Infiltration)
head(df)
unique(df$Quintile)
df[1:100,]
# load infiltration data:
df <- fread('~/Documents/Research/GTEx/Infiltration/GTEx_infil/output/infiltration_profiles/GTEx_v7_genexpr_ALL.CIBERSORT.ABS-F.QN-F.perm-1000.txt',data.table = F,stringsAsFactors = F)
x <- as.data.frame(table(df$SMTSD)); tis <- subset(x,Freq>=70)$Var1; tis <- tis[!(tis %in% c('Cells - Transformed fibroblasts','Cells - EBV-transformed lymphocytes'))]
df <- subset(df, SMTSD %in% tis)
ciber.rel <- df[,c('Input Sample','SMTSD',cellTypes.df$ciber)]
colnames(ciber.rel)[-c(1:2)] <- paste0(cellTypes.df$ciber,'.CIB_Rel')
# Written by Andrew Marderstein (2018-2019). Contact: anm2868@med.cornell.edu
# Script: generate boxplots to compare cell type scores across tissues and between deconvolution methods
# load
library(data.table)
library(ggplot2)
library('cowplot')
# cell type of interest:
cellTypes.df <- data.frame(
ciber=c('T cells CD8','T cells CD4 naive','CD4_memory','Neutrophils','MacrophageSum',
'Bcellsum','NK_Sum','DendriticSum','MastSum','Myeloid_Sum',
'T cells follicular helper','T cells regulatory (Tregs)','T cells gamma delta',
'Monocytes','Eosinophils','Lymph_Sum'),
xcell=c('CD8Sum','CD4+ naive T-cells','CD4_memory','Neutrophils','MacrophageSum',
'Bcellsum','NK cells','DendriticSum','Mast cells','Myeloid_Sum',
'Th_Sum','Tregs','Tgd cells',
'Monocytes','Eosinophils','Lymph_Sum'),
stringsAsFactors = F)
celltype.label.vec <- c('CD8+ T cells','CD4+ naive T cells','CD4+ memory T cells','Neutrophils','Macrophages',
'B cells','NK cells','Dendritic cells','Mast cells','Myeloid cells',
'Helper T cells','Tregs','Gamma delta T cells',
'Monocytes','Eosinophils','Lymphocytes')
# load infiltration data:
df <- fread('~/Documents/Research/GTEx/Infiltration/GTEx_infil/output/infiltration_profiles/GTEx_v7_genexpr_ALL.CIBERSORT.ABS-F.QN-F.perm-1000.txt',data.table = F,stringsAsFactors = F)
x <- as.data.frame(table(df$SMTSD)); tis <- subset(x,Freq>=70)$Var1; tis <- tis[!(tis %in% c('Cells - Transformed fibroblasts','Cells - EBV-transformed lymphocytes'))]
df <- subset(df, SMTSD %in% tis)
ciber.rel <- df[,c('Input Sample','SMTSD',cellTypes.df$ciber)]
colnames(ciber.rel)[-c(1:2)] <- paste0(cellTypes.df$ciber,'.CIB_Rel')
dim(df)
dim(ciber.rel)
length(tis)
df <- fread('~/Documents/Research/GTEx/Infiltration/GTEx_infil/output/infiltration_profiles/XCell.all_tissues.txt',data.table = F,stringsAsFactors = F)
df <- subset(df, SMTSD %in% tis)
xcell <- df[,c('SAMP',cellTypes.df$xcell)]
colnames(xcell)[-1] <- paste0(cellTypes.df$ciber,'.xCell')
dim(xcell)

library(data.table)
pheno <- 'bmi'
# pheno <- 'lymphocyte.count'
f1 <- paste0('/athena/elementolab/scratch/anm2868/vQTL/ukb_vqtl/output/vGWAS_subset/ukbb.',paste0(pheno,'.ALL'),'.vGWAS.txt')
f2 <- paste0('/athena/elementolab/scratch/anm2868/vQTL/ukb_vqtl/output/vGWAS_subset/ukbb.',paste0(pheno,'.rint.ALL'),'.vGWAS.txt')
f3 <- paste0('/athena/elementolab/scratch/anm2868/vQTL/ukb_vqtl/output/imputed/results/ukbb.',paste0(pheno,'.ALL'),'.results.txt')
f1
f2
f3
f2
f3
.05/3000
mean <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/imputed/results/ukbb.bmi.ALL.results.txt',data.table = F,stringsAsFactors = F)
# df.var <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_subset/ukbb.lymphocyte.count.ALL.vGWAS.txt',data.table = F,stringsAsFactors = F)
var_rint <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_subset/ukbb.bmi.rint.ALL.vGWAS.txt',data.table = F,stringsAsFactors = F)
var_raw <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_subset/ukbb.bmi.ALL.vGWAS.txt',data.table = F,stringsAsFactors = F)
df <- merge(mean,var_raw,by.x='SNP',by.y='rs')
df2 <- merge(df,var_rint,by.x='SNP',by.y='rs')
head(df2)
g1 <- ggplot(df2,aes(x=BETA.x,y=BETA.y)) + geom_point() + geom_smooth(col='red',method='lm') + labs(x='Mean effects',y='Variance effects')
library(ggplot2)
library(data.table)
g1 <- ggplot(df2,aes(x=BETA.x,y=BETA.y)) + geom_point() + geom_smooth(col='red',method='lm') + labs(x='Mean effects',y='Variance effects')
g2 <- ggplot(df2,aes(x=-log10(P.x),y=-log10(P.y))) + geom_point() + geom_smooth(col='red',method='lm') + labs(x='Mean pval',y='Variance pval')
g1 <- ggplot(df2[1:1000,],aes(x=BETA.x,y=BETA.y)) + geom_point() + geom_smooth(col='red',method='lm') + labs(x='Mean effects',y='Variance effects')
g2 <- ggplot(df2[1:1000,],aes(x=-log10(P.x),y=-log10(P.y))) + geom_point() + geom_smooth(col='red',method='lm') + labs(x='Mean pval',y='Variance pval')
g1
g1
mean <- mean[,c('rs','CHR','BP','A1','A2','MAF','BETA','P')]
colnames(mean)[(ncol(mean)-1):ncol(mean)] <- paste0(colnames(mean)[(ncol(mean)-1):ncol(mean)],'.MEAN')
var.raw <- var.raw[,c('rs','BETA','P')]; colnames(var.raw)[2:3] <- paste0(colnames(var.raw)[2:3],'.VAR.RAW')
var.rint <- var.rint[,c('rs','BETA','P')]; colnames(var.rint)[2:3] <- paste0(colnames(var.rint)[2:3],'.VAR.RINT')
mean <- mean[,c('rs','CHR','BP','A1','A2','MAF','BETA','P')]
head(mean)
mean <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/imputed/results/ukbb.bmi.ALL.results.txt',data.table = F,stringsAsFactors = F)
head(mean)
colnames(mean)[1] <- 'rs'
mean <- mean[,c('rs','CHR','BP','A1','A2','MAF','BETA','P')]
colnames(mean)[(ncol(mean)-1):ncol(mean)] <- paste0(colnames(mean)[(ncol(mean)-1):ncol(mean)],'.MEAN')
var.raw <- var.raw[,c('rs','BETA','P')]; colnames(var.raw)[2:3] <- paste0(colnames(var.raw)[2:3],'.VAR.RAW')
rm(var_raw)
rm(var_rint)
var.rint <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_subset/ukbb.bmi.rint.ALL.vGWAS.txt',data.table = F,stringsAsFactors = F)
var.raw <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_subset/ukbb.bmi.ALL.vGWAS.txt',data.table = F,stringsAsFactors = F)
var.raw <- var.raw[,c('rs','BETA','P')]; colnames(var.raw)[2:3] <- paste0(colnames(var.raw)[2:3],'.VAR.RAW')
var.rint <- var.rint[,c('rs','BETA','P')]; colnames(var.rint)[2:3] <- paste0(colnames(var.rint)[2:3],'.VAR.RINT')
head(mean)
df.mg <- merge(merge(mean.raw,var.raw,by='rs'),var.rint,by='rs')
g1 <- ggplot(df.mg[1:1000,],aes(x=BETA.MEAN,y=BETA.VAR.RAW)) + geom_point() + geom_smooth(col='red',method='lm') + labs(x='Mean effects',y='Variance effects')
df.mg <- merge(merge(mean,var.raw,by='rs'),var.rint,by='rs')
df.mg.sub <- subset(df.mg,MAF < 0.05)
head(df.mg)
dim(df.mg)
dim(df.mg.sub)
df.mg.sub <- subset(df.mg,MAF > 0.05)
g1 <- ggplot(df.mg.sub[1:1000,],aes(x=BETA.MEAN,y=BETA.VAR.RAW)) + geom_point() + geom_smooth(col='red',method='lm') + labs(x='Mean effects',y='Variance effects')
g1
g1 <- ggplot(df.mg.sub[1:1000,],aes(x=BETA.MEAN,y=BETA.VAR.RAW)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Mean effects',y='Variance effects')
g2 <- ggplot(df.mg.sub[1:1000,],aes(x=-log10(P.x),y=-log10(P.y))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Mean pval',y='Variance pval')
g2
g2 <- ggplot(df.mg.sub[1:1000,],aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Mean pval',y='Variance pval')
g2
g1 <- ggplot(df.mg.sub[1:1000,],aes(x=BETA.MEAN,y=BETA.VAR.RAW)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Mean effects',y='Variance effects')
g2 <- ggplot(df.mg.sub[1:1000,],aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 mean p-values',y='-log10 raw variance p-values')
library(cowplot)
plot_grid(g1,g2)
?tiff
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=720,height=400)
plot_grid(g1,g2)
dev.off()
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=1400,height=700)
plot_grid(g1,g2)
dev.off()
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=720,height=400,pointsize = 24)
plot_grid(g1,g2)
dev.off()
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=720,height=400,pointsize = 100)
plot_grid(g1,g2)
dev.off()
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=720,height=400,res = 100)
plot_grid(g1,g2)
dev.off()
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=720,height=400,res = 200)
plot_grid(g1,g2)
dev.off()
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=720,height=400,res = 50)
plot_grid(g1,g2)
dev.off()
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=720,height=400)
plot_grid(g1,g2)
dev.off()
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=1400,height=700,res=100)
plot_grid(g1,g2)
dev.off()
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=1400,height=700,res=150)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub[1:1000,],aes(x=BETA.MEAN,y=BETA.VAR.RAW)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Mean effects',y='Raw variance effects')
g2 <- ggplot(df.mg.sub[1:1000,],aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 mean p-values',y='-log10 raw variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=1400,height=700,res=150)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub[1:1000,],aes(x=BETA.MEAN,y=BETA.VAR.RINT)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Mean effects',y='RINT variance effects')
g2 <- ggplot(df.mg.sub[1:1000,],aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 mean p-values',y='-log10 RINT variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.rint.png',width=1400,height=700,res=150)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub[1:1000,],aes(x=BETA.VAR.RAW,y=BETA.VAR.RINT)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Raw variance effects',y='RINT variance effects')
g2 <- ggplot(df.mg.sub[1:1000,],aes(x=-log10(P.VAR.RAW),y=-log10(P.VAR.RINT))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 raw variance p-values',y='-log10 RINT variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/var.raw_var.rint.png',width=1400,height=700,res=150)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub[1:1000,],aes(x=BETA.MEAN,y=BETA.VAR.RAW)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Mean effects',y='Raw variance effects')
g2 <- ggplot(df.mg.sub[1:1000,],aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 mean p-values',y='-log10 raw variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=1400,height=700,res=150)
plot_grid(g1,g2)
dev.off()
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=3000,height=1500,res=400)
plot_grid(g1,g2)
dev.off()
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RAW)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Mean effects',y='Raw variance effects')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RAW))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 mean p-values',y='-log10 raw variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.raw.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.VAR.RINT)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Mean effects',y='RINT variance effects')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.VAR.RINT))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 mean p-values',y='-log10 RINT variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_var.rint.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.VAR.RAW,y=BETA.VAR.RINT)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Raw variance effects',y='RINT variance effects')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.VAR.RAW),y=-log10(P.VAR.RINT))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 raw variance p-values',y='-log10 RINT variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/var.raw_var.rint.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
mean.rint <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/imputed/results/ukbb.bmi.rint.ALL.results.txt',data.table = F,stringsAsFactors = F)
dim(mean.rint)
colnames(mean.rint)[1] <- 'rs'
mean.rint <- mean.rint[,c('rs','CHR','BP','A1','A2','MAF','BETA','P')]
colnames(mean.rint)[1] <- 'rs'
mean.rint <- mean.rint[,c('rs','BETA','P')]
colnames(mean.rint)[2:3] <- paste0(colnames(mean.rint)[2:3],'.MEAN.RINT')
head(mean.rint)
# identify all significant interactions of interest
# try P < 0.05 to start. the GxE replicate well
results <- fread('/athena/elementolab/scratch/anm2868/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.ALL.ext.more_snp.txt',data.table = F,stringsAsFactors = F)
results <- subset(results,results[,4] < 1e-5)
head(df.mg)
head(mean.rint)
df.mg <- merge(df.mg,mean.rint,by='rs')
.05/100
head(df.mg)
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.MEAN.RINT)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Raw variance effects',y='RINT variance effects')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.MEAN.RINT))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 raw variance p-values',y='-log10 RINT variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_mean.rint.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN.RINT,y=BETA.VAR.RINT)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Raw variance effects',y='RINT variance effects')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN.RINT),y=-log10(P.VAR.RINT))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 raw variance p-values',y='-log10 RINT variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean.rint_var.rint.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN.RINT,y=BETA.VAR)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Raw variance effects',y='RINT variance effects')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN.RINT),y=-log10(P.VAR))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 raw variance p-values',y='-log10 RINT variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean.rint_var.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
df.mg.sub <- subset(df.mg,MAF > 0.05)
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.MEAN.RINT)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Raw variance effects',y='RINT variance effects')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.MEAN.RINT))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 raw variance p-values',y='-log10 RINT variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_mean.rint.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN.RINT,y=BETA.VAR.RINT)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Raw variance effects',y='RINT variance effects')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN.RINT),y=-log10(P.VAR.RINT))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 raw variance p-values',y='-log10 RINT variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean.rint_var.rint.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN.RINT,y=BETA.VAR)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Raw variance effects',y='RINT variance effects')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN.RINT),y=-log10(P.VAR))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 raw variance p-values',y='-log10 RINT variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean.rint_var.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
head(df.mg.sub)
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN.RINT,y=BETA.VAR.RAW)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='RINT mean effects',y='raw variance effects')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN.RINT),y=-log10(P.VAR.RAW))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 RINT mean p-values',y='-log10 raw variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean.rint_var.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN,y=BETA.MEAN.RINT)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='Raw mean effects',y='RINT mean effects')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN),y=-log10(P.MEAN.RINT))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 raw mean p-values',y='-log10 RINT mean p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean_mean.rint.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN.RINT,y=BETA.VAR.RINT)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='RINT mean effects',y='raw variance effects')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN.RINT),y=-log10(P.VAR.RINT))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 RINT mean p-values',y='-log10 raw variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean.rint_var.rint.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
g1 <- ggplot(df.mg.sub,aes(x=BETA.MEAN.RINT,y=BETA.VAR.RINT)) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='RINT mean effects',y='RINT variance effects')
g2 <- ggplot(df.mg.sub,aes(x=-log10(P.MEAN.RINT),y=-log10(P.VAR.RINT))) + geom_point() + geom_smooth(col='red',method='lm',se=F) + labs(x='-log10 RINT mean p-values',y='-log10 RINT variance p-values')
png('~/Documents/Research/vQTL/ukb_vqtl/output/GWAS/mean.rint_var.rint.png',width=3000,height=1500,res=200)
plot_grid(g1,g2)
dev.off()
f <- paste0('/athena/elementolab/scratch/anm2868/vQTL/ukb_vqtl/output/GxG_2/ukbb.',phenoName,'.merged_subset.LD.ld')
ld <- fread(f,data.table = F,stringsAsFactors = F)
f <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.validation.summary.txt'
validation <- fread(f,data.table = F,stringsAsFactors = F)
head(validation)
f <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/bmi.GxE.ALL_RESULTS.trim.txt'
df <- fread(f,data.table = F,stringsAsFactors = F)
head(df)
dim(df)
3031/7
library(qqman)
qq(df[,4])
qq(df[,6])
exp(-.07)
exp(-.0746)
library(qqman)
library(data.table)
df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxG_2/ETApukbb.lymphocyte.count.merged_subset.GxG.ALL_TRIMMED.epi.qt',data.table = F,stringsAsFactors = F)
library(qqman)
library(data.table)
df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxG_2/ETApukbb.lymphocyte.count.merged_subset.GxG.ALL_TRIMMED.epi.qt',data.table = F,stringsAsFactors = F)
df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxG_2/pukbb.lymphocyte.count.merged_subset.GxG.ALL_TRIMMED.epi.qt',data.table = F,stringsAsFactors = F)
df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxG_2/ukbb.lymphocyte.count.merged_subset.GxG.ALL_TRIMMED.epi.qt',data.table = F,stringsAsFactors = F)
head(df)
dim(df)
df.sub <- subset(df,CHR1==CHR2)
df.sub.cis <- subset(df,CHR1==CHR2)
df.sub.trans <- subset(df,CHR1!=CHR2)
head(df.sub.cis)
nrow(df.sub.cis)
nrow(df.sub.trans)
qq(df.sub.cis)
qq(df.sub.cis$P.80)
qq
?ppoints
f
o = -log10(sort(pvector, decreasing = FALSE))
pvector=df.sub.cis$P.80
o = -log10(sort(pvector, decreasing = FALSE))
e = -log10(ppoints(length(pvector)))
head(o)
head(e)
head(pvector)
?ppoints
head(e)
qq(df.sub.trans$P.80)
min(df.sub.trans$P.80)
.05/nrow(df.sub.trans)
head(df.sub.trans[order(df.sub.trans$P.80)[1:5],])
df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxG_2/ukbb.lymphocyte.count.merged_subset.GxG.ALL_TRIMMED.epi.qt',data.table = F,stringsAsFactors = F)
head(df)
dim(results.mg.3)
results.mg.3$SNP2[which(!(results.mg.3$SNP2 %in% results.mg.3$SNP1))[1]]
table(x$CHR1)
library(qqman)
library(data.table)
# df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxG_2/ukbb.lymphocyte.count.merged_subset.GxG.ALL_TRIMMED.epi.qt',data.table = F,stringsAsFactors = F)
f <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxG_2/ukbb.bmi.merged_subset.GxG.ALL_TRIMMED.epi.qt'
df <- fread(f,data.table = F,stringsAsFactors = F)
df.sub.cis <- subset(df,CHR1==CHR2)
df.sub.trans <- subset(df,CHR1!=CHR2)
qq(df$P.80)
qq(df.sub.trans$P.80)
df.save <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/GxE/GxE_results/lymphocyte.count.GxE.validation.summary.full.txt',data.table = F,stringsAsFactors = F)
ggplot(df.save,aes(x=-log10(thres),y=p,col=snps)) + geom_line() + geom_point() + theme_bw() +
labs(title='all qtls') +
ylim(0,1) + geom_hline(yintercept=0.5,linetype='dashed',col='red') +
geom_ribbon(aes(ymin=lower,ymax=upper),alpha=0.1) + ylim(0,1) +
theme(axis.title=element_blank()) + theme(legend.position = 'none')
head(df.save)
ggplot(df.save,aes(x=-log10(thres),y=p)) + geom_line() + geom_point() + theme_bw() +
labs(title='all qtls') +
ylim(0,1) + geom_hline(yintercept=0.5,linetype='dashed',col='red') +
geom_ribbon(aes(ymin=lower,ymax=upper),alpha=0.1) + ylim(0,1) +
theme(axis.title=element_blank()) + theme(legend.position = 'none')
head(df.mg)
cor(df.mg[,c(
'BETA.MEAN','BETA.VAR.RAW','BETA.VAR.RINT','BETA.MEAN.RINT')],use='p')
cor(-log10(df.mg[,c(
'P.MEAN','P.VAR.RAW','P.VAR.RINT','P.MEAN.RINT')]),use='p')

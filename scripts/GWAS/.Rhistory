?mclapply
library(parallel)
?mclapply
400*400
sqrt(81810)
sqrt(81811)
library(data.table)
0.05/1e5
# df.sub <- (df[,c(SNP1,SNP2,'resid1')])
#
# x <-paste0('resid1~',SNP1,'*',SNP2)
df.sub <- (df[,c(SNP1,SNP2,'lymphocyte.count.rint.na')])
library(data.table)
library(data.table)
df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/GxG/plot/GxG_data.txt',data.table = F,stringsAsFactors = F)
df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/GxG/plot/GxG_data.txt',data.table = F,stringsAsFactors = F)
df <- df[1:5000,]
library(ggplot2)
ggplot(df,aes(as.numeric(SNP2),pheno,col=as.factor(SNP1))) +
geom_jitter(position=position_jitter(width=.1, height=0)) +
geom_abline(slope=mod0$coefficients[2],intercept = mod0$coefficients[1],col='red') +
geom_abline(slope=mod1$coefficients[2],intercept = mod1$coefficients[1],col='green') +
geom_abline(slope=mod2$coefficients[2],intercept = mod2$coefficients[1],col='blue') +
labs(x=envir.factor,y=paste0(pheno)) + scale_color_discrete(name=SNP2)
x <-paste0('lymphocyte.count.rint.na','~',SNP2)
x <- formula(x)
mod0 <- lm(x,data=subset(df.sub,df.sub[,SNP1]==0))
SNP1 <- colnames(df)[1]
df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/GxG/plot/GxG_data.txt',data.table = F,stringsAsFactors = F)
SNP1 <- colnames(df)[1]
SNP2 <- colnames(df)[2]
df.sub <- df
df.sub <- df[1:5000,]
x <-paste0('lymphocyte.count.rint.na','~',SNP2)
x <- formula(x)
mod0 <- lm(x,data=subset(df.sub,df.sub[,SNP1]==0))
mod1 <- lm(x,data=subset(df.sub,df.sub[,SNP1]==1))
mod2 <- lm(x,data=subset(df.sub,df.sub[,SNP1]==2))
mod0
mod1
mod2
ggplot(df,aes(as.numeric(SNP2),pheno,col=as.factor(SNP1))) +
geom_jitter(position=position_jitter(width=.1, height=0)) +
geom_abline(slope=mod0$coefficients[2],intercept = mod0$coefficients[1],col='red') +
geom_abline(slope=mod1$coefficients[2],intercept = mod1$coefficients[1],col='green') +
geom_abline(slope=mod2$coefficients[2],intercept = mod2$coefficients[1],col='blue') +
labs(x=envir.factor,y=paste0(pheno)) + scale_color_discrete(name=SNP2)
ggplot(df,aes(as.numeric(SNP2),pheno,col=as.factor(SNP1))) +
geom_jitter(position=position_jitter(width=.1, height=0)) +
geom_abline(slope=mod0$coefficients[2],intercept = mod0$coefficients[1],col='red') +
geom_abline(slope=mod1$coefficients[2],intercept = mod1$coefficients[1],col='green') +
geom_abline(slope=mod2$coefficients[2],intercept = mod2$coefficients[1],col='blue') +
labs(x=SNP2,y=paste0(pheno)) + scale_color_discrete(name=SNP1)
library(data.table)
library(ggplot2)
df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/GxG/plot/GxG_data.txt',data.table = F,stringsAsFactors = F)
SNP1 <- colnames(df)[1]
SNP2 <- colnames(df)[2]
phenoName <- colnames(df)[3]
df.sub <- df
df.sub <- df[1:5000,]
x <-paste0('lymphocyte.count.rint.na','~',SNP2)
x <- formula(x)
mod0 <- lm(x,data=subset(df.sub,df.sub[,SNP1]==0))
mod1 <- lm(x,data=subset(df.sub,df.sub[,SNP1]==1))
mod2 <- lm(x,data=subset(df.sub,df.sub[,SNP1]==2))
ggplot(df,aes(as.numeric(SNP2),pheno,col=as.factor(SNP1))) +
geom_jitter(position=position_jitter(width=.1, height=0)) +
geom_abline(slope=mod0$coefficients[2],intercept = mod0$coefficients[1],col='red') +
geom_abline(slope=mod1$coefficients[2],intercept = mod1$coefficients[1],col='green') +
geom_abline(slope=mod2$coefficients[2],intercept = mod2$coefficients[1],col='blue') +
labs(x=SNP2,y=paste0(phenoName)) + scale_color_discrete(name=SNP1)
ggplot(df,aes(as.numeric(SNP2),phenoName,col=as.factor(SNP1))) +
geom_jitter(position=position_jitter(width=.1, height=0)) +
geom_abline(slope=mod0$coefficients[2],intercept = mod0$coefficients[1],col='red') +
geom_abline(slope=mod1$coefficients[2],intercept = mod1$coefficients[1],col='green') +
geom_abline(slope=mod2$coefficients[2],intercept = mod2$coefficients[1],col='blue') +
labs(x=SNP2,y=paste0(phenoName)) + scale_color_discrete(name=SNP1)
ggplot(df.sub,aes(as.numeric(SNP2),phenoName,col=as.factor(SNP1))) +
geom_jitter(position=position_jitter(width=.1, height=0)) +
geom_abline(slope=mod0$coefficients[2],intercept = mod0$coefficients[1],col='red') +
geom_abline(slope=mod1$coefficients[2],intercept = mod1$coefficients[1],col='green') +
geom_abline(slope=mod2$coefficients[2],intercept = mod2$coefficients[1],col='blue') +
labs(x=SNP2,y=paste0(phenoName)) + scale_color_discrete(name=SNP1)
head(df.sub)
df.sub[1:5,3]
ggplot(df.sub,aes(as.numeric(SNP2),df.sub[,phenoName],col=as.factor(SNP1))) +
geom_jitter(position=position_jitter(width=.1, height=0)) +
geom_abline(slope=mod0$coefficients[2],intercept = mod0$coefficients[1],col='red') +
geom_abline(slope=mod1$coefficients[2],intercept = mod1$coefficients[1],col='green') +
geom_abline(slope=mod2$coefficients[2],intercept = mod2$coefficients[1],col='blue') +
labs(x=SNP2,y=paste0(phenoName)) + scale_color_discrete(name=SNP1)
ggplot(df.sub,aes(as.numeric(df.sub[,SNP2]),df.sub[,phenoName],col=as.factor(SNP1))) +
geom_jitter(position=position_jitter(width=.1, height=0)) +
geom_abline(slope=mod0$coefficients[2],intercept = mod0$coefficients[1],col='red') +
geom_abline(slope=mod1$coefficients[2],intercept = mod1$coefficients[1],col='green') +
geom_abline(slope=mod2$coefficients[2],intercept = mod2$coefficients[1],col='blue') +
labs(x=SNP2,y=paste0(phenoName)) + scale_color_discrete(name=SNP1)
ggplot(df.sub,aes(as.numeric(df.sub[,SNP2]),df.sub[,phenoName],col=as.factor(df.sub[,SNP1]))) +
geom_jitter(position=position_jitter(width=.1, height=0)) +
geom_abline(slope=mod0$coefficients[2],intercept = mod0$coefficients[1],col='red') +
geom_abline(slope=mod1$coefficients[2],intercept = mod1$coefficients[1],col='green') +
geom_abline(slope=mod2$coefficients[2],intercept = mod2$coefficients[1],col='blue') +
labs(x=SNP2,y=paste0(phenoName)) + scale_color_discrete(name=SNP1)
df.sub <- df
x <-paste0('lymphocyte.count.rint.na','~',SNP2)
x <- formula(x)
mod0 <- lm(x,data=subset(df.sub,df.sub[,SNP1]==0))
mod1 <- lm(x,data=subset(df.sub,df.sub[,SNP1]==1))
mod2 <- lm(x,data=subset(df.sub,df.sub[,SNP1]==2))
mod0
mod1
mod2
df.sub <- df
df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/GxG/plot/GxG_data.txt',data.table = F,stringsAsFactors = F)
SNP1 <- colnames(df)[1]
SNP2 <- colnames(df)[2]
phenoName <- colnames(df)[3]
df.sub <- df
x <-paste0('lymphocyte.count.rint.na','~',SNP2)
x <- formula(x)
mod0 <- lm(x,data=subset(df.sub,df.sub[,SNP1]==0))
mod1 <- lm(x,data=subset(df.sub,df.sub[,SNP1]==1))
mod2 <- lm(x,data=subset(df.sub,df.sub[,SNP1]==2))
mod0
mod1
mod2
ggplot(df.sub,aes(as.numeric(df.sub[,SNP2]),df.sub[,phenoName],col=as.factor(df.sub[,SNP1]))) +
geom_jitter(position=position_jitter(width=.1, height=0)) +
geom_abline(slope=mod0$coefficients[2],intercept = mod0$coefficients[1],col='red') +
geom_abline(slope=mod1$coefficients[2],intercept = mod1$coefficients[1],col='green') +
geom_abline(slope=mod2$coefficients[2],intercept = mod2$coefficients[1],col='blue') +
labs(x=SNP2,y=paste0(phenoName)) + scale_color_discrete(name=SNP1)
ggplot(df.sub,aes(as.factor(df.sub[,SNP2]),df.sub[,phenoName],col=as.factor(df.sub[,SNP1]))) +
geom_boxplot(outlier.shape = NA) +
labs(x=SNP2,y=paste0(phenoName)) + scale_color_discrete(name=SNP1)
ggplot(df.sub,aes(as.factor(df.sub[,SNP1]),df.sub[,phenoName],col=as.factor(df.sub[,SNP2]))) +
geom_boxplot(outlier.shape = NA) +
labs(x=SNP1,y=paste0(phenoName)) + scale_color_discrete(name=SNP2)
df.sub <- subset(df,!(is.na(SNP1)) & !(is.na(SNP2)))
ggplot(df.sub,aes(as.factor(df.sub[,SNP1]),df.sub[,phenoName],col=as.factor(df.sub[,SNP2]))) +
geom_boxplot(outlier.shape = NA) +
labs(x=SNP1,y=paste0(phenoName)) + scale_color_discrete(name=SNP2)
dim(df.sub)
df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/GxG/plot/GxG_data.txt',data.table = F,stringsAsFactors = F)
dim(df)
df.sub <- subset(df,!(is.na(SNP1)) & !(is.na(SNP2)))
dim(df.sub)
head(df.sub)
head(df.sub,20)
which(is.na(df.sub$SNP1))[1:3]
which(is.na(df.sub$SNP1))
which(is.na(df.sub$SNP2))
df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/GxG/plot/GxG_data.txt',data.table = F,stringsAsFactors = F)
df.sub <- df
which(is.na(df.sub$SNP2))
summary(df.sub)
df.sub <- subset(df,!(is.na(df.sub[,SNP1])) & !(is.na(df.sub[,SNP2])))
dim(df.sub)
df.sub <- df
df.sub <- subset(df,!(is.na(df.sub[,SNP1])) & !(is.na(df.sub[,SNP2])))
ggplot(df.sub,aes(as.factor(df.sub[,SNP1]),df.sub[,phenoName],col=as.factor(df.sub[,SNP2]))) +
geom_boxplot(outlier.shape = NA) +
labs(x=SNP1,y=paste0(phenoName)) + scale_color_discrete(name=SNP2)
aggregate(df.sub$lymphocyte.count.rint.na,by=list(df.sub$rs887468),var,na.rm=T)
aggregate(df.sub$lymphocyte.count.rint.na,by=list(df.sub$rs2516491),var,na.rm=T)
ggplot(df.sub,aes(as.numeric(df.sub[,SNP2]),df.sub[,phenoName],col=as.factor(df.sub[,SNP1]))) +
geom_jitter(position=position_jitter(width=.1, height=0),alpha=0.1) +
geom_abline(slope=mod0$coefficients[2],intercept = mod0$coefficients[1],col='red') +
geom_abline(slope=mod1$coefficients[2],intercept = mod1$coefficients[1],col='green') +
geom_abline(slope=mod2$coefficients[2],intercept = mod2$coefficients[1],col='blue') +
labs(x=SNP2,y=paste0(phenoName)) + scale_color_discrete(name=SNP1)
(ncol(res.sub)-1):ncol(res.sub)
s <- '80'
f.res <- paste0('/athena/elementolab/scratch/anm2868/vQTL/ukb_vqtl/output/GxG/ukbb.lymphocyte.count.rint.ALL.ALL.sub.GxG.epi.qt')
results <- fread(f.res,data.table = F,stringsAsFactors = F)
library(stringr)
?str_replace_all
str_replace_all('happy.sad.nah','\\.','-')
str_replace_all('happy-sad-nah','\\.','-')
str_replace_all('happy-sa-nah','\\.','-')
str_replace_all('happy-sanah','-','.')
df.sub <- subset(df,CHR1!=CHR2 & SNP2=='rs146125856')
df <- fread('/athena/elementolab/scratch/anm2868/vQTL/ukb_vqtl/output/GxG/ukbb.lymphocyte.count.rint.ALL.ALL.sub.GxG.epi.qt',data.table=F,stringsAsFactors = F)
phenoName <- 'lymphocyte.count.rint.ALL'
x <- strsplit(phenoName,'\\.')[[1]]; phenoName2 <- paste0(c(x[-length(x)],'na'),collapse='.')
lm(lymphocyte.count.rint.na ~ SCORE + rnorm(df.save[,'SCORE'],0.00001),data=df.save)
mod.formula <- paste0(phenoName2,'~','PGS.epi+SCORE+age+as.factor(menopause2)')
library(data.table)
phenoName <- 'lymphocyte.count.rint.ALL'
gtex.popu <- fread('~/Documents/Research/GTEx/Infiltration/gtex_pops.txt',data.table = F,stringsAsFactors = F)
?df.mg2
?df.mg2
?aggregate
table(df.mg2$SMTSD)
GENE_LIST <- c('KHK',rep('PPFIBP2',2),rep('CYB5R2',2))
rep(c('NR4A2','TYR','TH'),3)
GENE_LIST <- c(# GENE_LIST,
rep(c('NR4A2','TYR','TH'),each=3),
rep('KHK',each=3),
rep(c('PPFIBP2', 'CYB5R2','TUSC3', 'BVES', 'POPDC3'),each=10),
rep('LCT',each=1)
)
TISSUE_LIST <- c(# TISSUE_LIST,
rep(c('Skin - Not Sun Exposed (Suprapubic)','Skin - Sun Exposed (Lower leg)','Brain - Substantia nigra','Whole Blood'),3),
rep(c('Liver','Kidney - Cortex','Small Intestine - Terminal Ileum'),1),
rep(c('Kidney - Cortex', 'Brain - Cerebellum', 'Heart - Left Ventricle', 'Nerve - Tibial', 'Prostate', 'Artery - Aorta','Stomach', 'Brain - Frontal Cortex (BA9)', 'Artery - Tibial', 'Whole Blood'),5)
rep(c('Small Intestine - Terminal Ileum'))
)
TISSUE_LIST <- c(# TISSUE_LIST,
rep(c('Skin - Not Sun Exposed (Suprapubic)','Skin - Sun Exposed (Lower leg)','Brain - Substantia nigra','Whole Blood'),3),
rep(c('Liver','Kidney - Cortex','Small Intestine - Terminal Ileum'),1),
rep(c('Kidney - Cortex', 'Brain - Cerebellum', 'Heart - Left Ventricle', 'Nerve - Tibial', 'Prostate', 'Artery - Aorta','Stomach', 'Brain - Frontal Cortex (BA9)', 'Artery - Tibial', 'Whole Blood'),5),
rep(c('Small Intestine - Terminal Ileum'))
)
?wilcox.test
?t.test

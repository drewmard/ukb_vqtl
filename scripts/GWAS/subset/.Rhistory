G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p <- 1
while (p > 1e-2) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
while (p > 1e-3) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.5,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
p1
p
p2
p3
p <- 1
while (p > 1e-3) {
G <- rbinom(250,2,0.25)
pheno <- create_pheno(250,r=0.3,to_plot=FALSE)
p <- summary(lm(pheno[1,]~G))$coef[2,4]
}
p2 <- summary(lm(pheno[2,]~G))$coef[2,4]
p3 <- summary(lm(pheno[3,]~G))$coef[2,4]
p_values <- c(p,p2,p3) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm
library(EmpiricalBrownsMethod)
# Slightly modified version of empiricalBrowsMethod that allows a pre-calculated covariance matrix
# Much more efficient if you have to run empiricalBrownsMethod multiple times with the same data_matrix
# https://github.com/IlyaLab/CombiningDependentPvaluesUsingEBM/issues/1
empiricalBrownsMethod2 <- function(p_values, extra_info, data_matrix, covar_matrix) {
if (missing(covar_matrix)) covar_matrix = EmpiricalBrownsMethod:::calculateCovariances(data_matrix)
return(EmpiricalBrownsMethod:::combinePValues(covar_matrix, p_values, extra_info))
}
create_pheno <- function(N,r,to_plot=FALSE) {
# create the initial x variable
x1 <- rnorm(N, 15, 5)
# x2, x3, and x4 in a matrix, these will be modified to meet the criteria
x234 <- scale(matrix( rnorm(N*2), ncol=2 ))
# put all into 1 matrix for simplicity
x1234 <- cbind(scale(x1),x234)
# find the current correlation matrix
c1 <- var(x1234)
# cholesky decomposition to get independence
chol1 <- solve(chol(c1))
newx <-  x1234 %*% chol1
# check that we have independence and x1 unchanged
zapsmall(cor(newx))
all.equal( x1234[,1], newx[,1] )
# create new correlation structure (zeros can be replaced with other rvals)
newc <- matrix(
c(1  , r, r,
r, 1  , r ,
r, r , 1), ncol=3 )
# check that it is positive definite
eigen(newc)
chol2 <- chol(newc)
finalx <- newx %*% chol2 * sd(x1) + mean(x1)
zapsmall(cor(finalx))
if (to_plot) {print(pairs(finalx))}
pheno <- t(finalx )
return(pheno)
}
p.vec <- c(1,1e-1,1e-2,1e-3,1e-4,1e-5,1e-6,1e-7,1e-8)
# r.vec <- seq(0.2,0.9,by=0.1)
r.vec <- c(0.5)
nsim <- 100
for (k in 1:length(r.vec)) {
r <- r.vec[k]
for (j in 1:length(p.vec)) {
print(j)
p <- p.vec[j]
p.ebm.vec <- rep(NA,nsim)
for (i in 1:nsim){
pheno <- create_pheno(250,r,to_plot=FALSE)
cov.matrix <- EmpiricalBrownsMethod:::calculateCovariances(pheno)
p_values <- c(p,p,p) # hard coded (same as calculated above)
p1 <- 5e-8
p2 <- p
p_values <- c(p1,p2,p2) # hard coded (same as calculated above)
p.ebm <- empiricalBrownsMethod2(data_matrix = pheno,p_values = p_values,extra_info = F,covar_matrix = cov.matrix)
p.ebm.vec[i] <- p.ebm
}
# df.tmp <- data.frame(p,r,mean(p.ebm.vec),sd(p.ebm.vec))
df.tmp <- data.frame(p,r,p.ebm.vec)
if (j==1 & k==1) {
df.save <- df.tmp
} else {
df.save <- rbind(df.save,df.tmp)
}
}
}
library(ggplot2)
df.save$r <- as.factor(df.save$r)
ggplot(df.save,aes(x=-log10(p),y=-log10(p.ebm.vec),group=r)) + theme_bw() + geom_abline(intercept = -log10(5e-8),slope=0,col='red',lty='dashed') + geom_smooth(aes(col=r)) +
geom_abline(slope=1,intercept = 0,col='black',lty='dashed') + labs(x='Observed -log10 p-value',y="Empirical Brown's method -log10 p-value") + geom_jitter(alpha=0.05,width = 0.1) +
theme(legend.position ='none')
?calculateCovariances
?EmpiricalBrownsMethod:::calculateCovariances
EmpiricalBrownsMethod
EmpiricalBrownsMethod:::calculateCovariances
combinePValues
EmpiricalBrownsMethod:::combinePValues
library(data.table)
infil_pheno <- fread('/Users/andrewmarderstein/Documents/Research/GTEx/Infiltration/GTEx_infil/output/infiltration_phenotypes.txt',data.table = F,stringsAsFactors = F)
infil_pheno
i=95
library(data.table)
phenoName <- 'lymphocyte.count.rint.ALL'
library(data.table)
phenoName <- 'lymphocyte.count.rint.ALL'
s <- '80'
df <- fread('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/ukbb.monocyte.count.rint.ALL.ALL.sub.GxG.80.epi.qt',data.table = F,stringsAsFactors = F)
s <- '80'
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_GxG/ukbb.',phenoName,'.ALL.sub.GxG.',s,'.epi.qt')
df.80 <- fread(f,data.table = F,stringsAsFactors = F)
phenoName <- 'monocyte.count.rint.ALL'
s <- '80'
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_GxG/ukbb.',phenoName,'.ALL.sub.GxG.',s,'.epi.qt')
df.80 <- fread(f,data.table = F,stringsAsFactors = F)
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_GxG/ukbb.',phenoName,'.ALL.sub.GxG.',s,'.epi.qt')
f
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_GxG/ukbb.',phenoName,'.ALL.sub.GxG.',s,'.epi.qt')
df.80 <- fread(f,data.table = F,stringsAsFactors = F)
s <- '20'
df.20 <- fread(paste0('/athena/elementolab/scratch/anm2868/vQTL/ukb_vqtl/output/vGWAS_GxG/ukbb.',phenoName,'.ALL.sub.GxG.',s,'.epi.qt'),data.table=F,stringsAsFactors = F)
colnames(df.20)[5:7] <- paste0(colnames(df.20)[5:7],'.',s)
df.20 <- fread(paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_GxG/ukbb.',phenoName,'.ALL.sub.GxG.',s,'.epi.qt'),data.table=F,stringsAsFactors = F)
colnames(df.20)[5:7] <- paste0(colnames(df.20)[5:7],'.',s)
source('~/.active-rstudio-document', echo=TRUE)
df <- merge(df.80,df.20,by=c('CHR1','SNP1','CHR2','SNP2'))
head(df)
df.sub <- subset(df,CHR1==CHR2)
dim(df.sub)
plot(df$BETA_INT.80,df$BETA_INT.20)
plot(df.sub$BETA_INT.80,df.sub$BETA_INT.20)
plot(df.sub$BETA_INT.80,df.sub$BETA_INT.20)
ggplot(df.sub,aes(BETA_INT.80,BETA_INT.20) + geom_point()
ggplot(df.sub,aes(BETA_INT.80,BETA_INT.20)) + geom_point()
df.sub <- subset(df,CHR1!=CHR2 & P.80 < 1e-5)
dim(df.sub)
df.sub <- subset(df,CHR1!=CHR2 & P.80 < 0.05)
ggplot(df.sub,aes(BETA_INT.80,BETA_INT.20)) + geom_point()
sum(df.sub$BETA_INT.80==df.sub$BETA_INT.20)
sum(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1!=CHR2 & P.80 < 0.05)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1!=CHR2 & P.80 < 1e-5)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1!=CHR2 & P.80 < 1e-3)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1!=CHR2 & P.80 < 1e-2)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1!=CHR2 & P.80 < 1)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2 & P.80 < 0.05)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2 & P.80 < 1e-3)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2 & P.80 < 0.05)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2 & P.80 < 1e-3)
dim(df.sub)
df.sub
df.sub <- subset(df,CHR1==CHR2 & P.80 < 1e-3)
unique(df.sub$CHR1)
ggplot(df.sub,aes(BETA_INT.80,BETA_INT.20)) + geom_point()
df.sub <- subset(df,CHR1==CHR2)
nrow(df.sub)
.05/92671
df.sub <- subset(df,CHR1==CHR2 & P.80 < 6e-7)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2 & P.80 < 1e-7)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2)
df.sub <- subset(df.sub,P < 0.05 / nrow(df.sub))
df.sub <- subset(df,CHR1==CHR2)
df.sub <- subset(df.sub,P.80 < 0.05 / nrow(df.sub))
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1@=CHR2)
df.sub <- subset(df,CHR1!=CHR2)
df.sub <- subset(df.sub,P.80 < 0.05 / nrow(df.sub))
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub
df.sub <- subset(df,CHR1==CHR2 & P.80 < 1e-3)
ggplot(df.sub,aes(BETA_INT.80,BETA_INT.20)) + geom_point()
df.sub <- subset(df,CHR1==CHR2 & P.80 < 0.05)
ggplot(df.sub,aes(BETA_INT.80,BETA_INT.20)) + geom_point()
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2)
df.sub <- subset(df,CHR1==CHR2 & P.80 < 0.05)
# ggplot(df.sub,aes(BETA_INT.80,BETA_INT.20)) + geom_point()
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2 & P.80 < 1e-3)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2 & P.80 < 1)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2 & P.80 < 0.05)
# ggplot(df.sub,aes(BETA_INT.80,BETA_INT.20)) + geom_point()
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2 & P.80 < 1e-3)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2)
df.sub <- subset(df.sub,P.80 < 0.05 / nrow(df.sub))
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2 & P.80 < 0.05)
# ggplot(df.sub,aes(BETA_INT.80,BETA_INT.20)) + geom_point()
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2 & P.80 < 1e-3)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2 & P.80 < 1e-5)
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1==CHR2)
df.sub <- subset(df.sub,P.80 < 0.05 / nrow(df.sub))
mean(sign(df.sub$BETA_INT.80)==sign(df.sub$BETA_INT.20))
df.sub <- subset(df,CHR1!=CHR2)
df.sub <- subset(df.sub,P.80 < 0.05 / nrow(df.sub))
df.sub
library(qqman)
install.packages("qqman")
library(qqman)
df.sub <- subset(df,CHR1==CHR2)
nrow(df.sub)
qq(df.sub$P.80)
df.sub <- subset(df,CHR1!=CHR2)
qq(df.sub$P.80)
df.sub <- subset(df,CHR1==CHR2)
qq(df.sub$P.80)
phenoName
?png
?tiff
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/vGWAS_GxG/plot/',phenoName,'.cis.png')
df.sub <- subset(df,CHR1==CHR2)
df.sub <- subset(df,CHR1==CHR2)
df.sub <- df.sub[1:5000,]
qq(df.sub$P.80)
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/vGWAS_GxG/plot/',phenoName,'.cis.png')
x = 1
png(f,width = 360*x,height=360*x)
qq(df.sub$P.80)
dev.off()
df.sub <- df.sub[1:5000,]
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_GxG/plot/',phenoName,'.cis.png')
x = 1
png(f,width = 360*x,height=360*x)
qq(df.sub$P.80)
dev.off()
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_GxG/plot/',phenoName,'.cis.png')
x = 1
png(f,width = 360*x,height=360*x)
qq(df.sub$P.80)
dev.off()
png(f,width = 360*x,height=360*x,res=300)
qq(df.sub$P.80)
dev.off()
png(f,width = 360*x,height=360*x,res=100)
qq(df.sub$P.80)
dev.off()
tiff(f,width = 360*x,height=360*x,res=100)
qq(df.sub$P.80)
dev.off()
tiff(f,width = 360*x,height=360*x,res=300)
qq(df.sub$P.80)
dev.off()
x = 3
tiff(f,width = 360*x,height=360*x,res=300)
qq(df.sub$P.80)
dev.off()
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_GxG/plot/',phenoName,'.cis.png')
x = 3
tiff(f,width = 340*x,height=370*x,res=300)
qq(df.sub$P.80)
dev.off()
qq(df.sub$P.80,cex.axis = 0.8)
qq(df.sub$P.80,cex.axis = 0.8)
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_GxG/plot/',phenoName,'.cis.png')
x = 3
tiff(f,width = 340*x,height=370*x,res=300)
# qq(df.sub$P.80)
qq(df.sub$P.80,cex.axis = 0.8)
dev.off()
df.sub <- subset(df,CHR1!=CHR2)
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_GxG/plot/',phenoName,'.trans.png')
tiff(f,width = 340*x,height=370*x,res=300)
qq(df.sub$P.80,cex.axis = 0.8)
dev.off()
df.sub <- subset(df,CHR1==CHR2)
# df.sub <- df.sub[1:5000,]
f <- paste0('/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/vGWAS_GxG/plot/',phenoName,'.cis.png')
x = 3
tiff(f,width = 340*x,height=370*x,res=300)
# qq(df.sub$P.80)
qq(df.sub$P.80,cex.axis = 0.8)
dev.off()

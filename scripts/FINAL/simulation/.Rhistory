library(data.table)
library(ggplot2)
library(cowplot)
library(reshape2)
# parameters
MAF1 <- 0.4
MAF1 <- 0.1
MAF2 <- 0.4
nsim <- 1000;
nindiv <- 10000
simulation_type='gxg'
genetic_variance_explained.vec <- seq(0.01,0.1,by=0.01);
simulation_type <- 'gxg'
phenotype_noise <- 'NORMAL'
dir='/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f=paste0(dir,'MAF1_',MAF1,'.MAF2_',MAF2,'.NSIM_',nsim,'.NINDIV_',nindiv,'.TYPE_',simulation_type,'.NOISE_',phenotype_noise,'.txt')
df1 <- fread(f,data.table = F,stringsAsFactors = F)
phenotype_noise <- 'CHISQ4'
dir='/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f=paste0(dir,'MAF1_',MAF1,'.MAF2_',MAF2,'.NSIM_',nsim,'.NINDIV_',nindiv,'.TYPE_',simulation_type,'.NOISE_',phenotype_noise,'.txt')
df2 <- fread(f,data.table = F,stringsAsFactors = F)
df.mg <- rbind(df1,df2)
simulation_type <- 'mean'
phenotype_noise <- 'NORMAL'
dir='/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f=paste0(dir,'MAF1_',MAF1,'.MAF2_',MAF2,'.NSIM_',nsim,'.NINDIV_',nindiv,'.TYPE_',simulation_type,'.NOISE_',phenotype_noise,'.txt')
df1 <- fread(f,data.table = F,stringsAsFactors = F)
df.mg <- rbind(df.mg,df1)
phenotype_noise <- 'CHISQ4'
dir='/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f=paste0(dir,'MAF1_',MAF1,'.MAF2_',MAF2,'.NSIM_',nsim,'.NINDIV_',nindiv,'.TYPE_',simulation_type,'.NOISE_',phenotype_noise,'.txt')
df2 <- fread(f,data.table = F,stringsAsFactors = F)
df.mg <- rbind(df.mg,df2)
library(data.table)
library(ggplot2)
library(cowplot)
library(reshape2)
# parameters
MAF1 <- 0.4
MAF1 <- 0.1
MAF2 <- 0.4
nsim <- 1000;
nindiv <- 10000
simulation_type='gxg'
genetic_variance_explained.vec <- seq(0.01,0.1,by=0.01);
simulation_type <- 'gxg'
phenotype_noise <- 'NORMAL'
dir='/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f=paste0(dir,'MAF1_',MAF1,'.MAF2_',MAF2,'.NSIM_',nsim,'.NINDIV_',nindiv,'.TYPE_',simulation_type,'.NOISE_',phenotype_noise,'.txt')
df1 <- fread(f,data.table = F,stringsAsFactors = F)
library(reshape2)
# parameters
MAF1 <- 0.4
# MAF1 <- 0.1
MAF2 <- 0.4
nsim <- 1000;
nindiv <- 10000
simulation_type='gxg'
genetic_variance_explained.vec <- seq(0.01,0.1,by=0.01);
simulation_type <- 'gxg'
phenotype_noise <- 'NORMAL'
dir='/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f=paste0(dir,'MAF1_',MAF1,'.MAF2_',MAF2,'.NSIM_',nsim,'.NINDIV_',nindiv,'.TYPE_',simulation_type,'.NOISE_',phenotype_noise,'.txt')
df1 <- fread(f,data.table = F,stringsAsFactors = F)
phenotype_noise <- 'CHISQ4'
dir='/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f=paste0(dir,'MAF1_',MAF1,'.MAF2_',MAF2,'.NSIM_',nsim,'.NINDIV_',nindiv,'.TYPE_',simulation_type,'.NOISE_',phenotype_noise,'.txt')
df2 <- fread(f,data.table = F,stringsAsFactors = F)
df.mg <- rbind(df1,df2)
simulation_type <- 'mean'
phenotype_noise <- 'NORMAL'
dir='/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f=paste0(dir,'MAF1_',MAF1,'.MAF2_',MAF2,'.NSIM_',nsim,'.NINDIV_',nindiv,'.TYPE_',simulation_type,'.NOISE_',phenotype_noise,'.txt')
df1 <- fread(f,data.table = F,stringsAsFactors = F)
df.mg <- rbind(df.mg,df1)
phenotype_noise <- 'CHISQ4'
dir='/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f=paste0(dir,'MAF1_',MAF1,'.MAF2_',MAF2,'.NSIM_',nsim,'.NINDIV_',nindiv,'.TYPE_',simulation_type,'.NOISE_',phenotype_noise,'.txt')
df2 <- fread(f,data.table = F,stringsAsFactors = F)
df.mg <- rbind(df.mg,df2)
dim(df.mg)
head(df.mg)
workdir <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f <- paste0(workdir,'MAF1_0.1.MAF2_0.4.NSIM_1000.NINDIV_10000.TYPE_gxg.NOISE_NORMAL.txt')
library(data.table)
workdir <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f <- paste0(workdir,'MAF1_0.1.MAF2_0.4.NSIM_1000.NINDIV_10000.TYPE_gxg.NOISE_NORMAL.txt')
library(data.table)
workdir <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f <- paste0(workdir,'MAF1_0.1.MAF2_0.4.NSIM_1000.NINDIV_10000.TYPE_gxg.NOISE_NORMAL.txt')
df <- fread(f,data.table = F,stringsAsFactors = F)
head(Df)
head(df)
library(data.table)
workdir <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
MAF1=0.1
f <- paste0(workdir,'MAF1_',MAF1,'.MAF2_0.4.NSIM_1000.NINDIV_10000.TYPE_gxg.NOISE_NORMAL.txt')
df[[MAF1]] <- fread(f,data.table = F,stringsAsFactors = F)
library(data.table)
workdir <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f <- paste0(workdir,'MAF1_',MAF1,'.MAF2_0.4.NSIM_1000.NINDIV_10000.TYPE_gxg.NOISE_NORMAL.txt')
df[[MAF1]] <- fread(f,data.table = F,stringsAsFactors = F)
df <- do.call(rbind,df)
library(data.table)
workdir <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
MAF1=0.1
f <- paste0(workdir,'MAF1_',MAF1,'.MAF2_0.4.NSIM_1000.NINDIV_10000.TYPE_gxg.NOISE_NORMAL.txt')
df[[MAF1]] <- fread(f,data.table = F,stringsAsFactors = F)
library(data.table)
df <- list()
workdir <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
MAF1=0.1
f <- paste0(workdir,'MAF1_',MAF1,'.MAF2_0.4.NSIM_1000.NINDIV_10000.TYPE_gxg.NOISE_NORMAL.txt')
df[[MAF1]] <- fread(f,data.table = F,stringsAsFactors = F)
MAF1=0.4
library(data.table)
df <- list()
workdir <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
MAF1=0.1
f <- paste0(workdir,'MAF1_',MAF1,'.MAF2_0.4.NSIM_1000.NINDIV_10000.TYPE_gxg.NOISE_NORMAL.txt')
df[[MAF1]] <- fread(f,data.table = F,stringsAsFactors = F)
library(data.table)
df <- list()
workdir <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
MAF1=0.1
f <- paste0(workdir,'MAF1_',MAF1,'.MAF2_0.4.NSIM_1000.NINDIV_10000.TYPE_gxg.NOISE_NORMAL.txt')
df[[MAF1]] <- fread(f,data.table = F,stringsAsFactors = F)
f
df[[1]] <- fread(f,data.table = F,stringsAsFactors = F)
library(data.table)
df <- list()
workdir <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
MAF1=0.1
f <- paste0(workdir,'MAF1_',MAF1,'.MAF2_0.4.NSIM_1000.NINDIV_10000.TYPE_gxg.NOISE_NORMAL.txt')
df[[1]] <- fread(f,data.table = F,stringsAsFactors = F)
MAF1=0.4
workdir <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f <- paste0(workdir,'MAF1_',MAF1,'.MAF2_0.4.NSIM_1000.NINDIV_10000.TYPE_gxg.NOISE_NORMAL.txt')
df[[2]] <- fread(f,data.table = F,stringsAsFactors = F)
df <- do.call(rbind,df)
head(df)
df.aggre <- aggregate(.~MAF1+MAF2+N+noise+h+type,df,function(x) {mean(x < 0.05)})
df.aggre
df.aggre <- aggregate(.~MAF1+MAF2+N+noise+h+type,df,mean)
df.aggre
library(data.table)
df <- list()
workdir <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
MAF1=0.4
nindiv=10000
f <- paste0(workdir,'MAF1_',MAF1,'.MAF2_0.4.NSIM_1000.NINDIV_',nindiv,'.TYPE_gxg.NOISE_NORMAL.txt')
df[[1]] <- fread(f,data.table = F,stringsAsFactors = F)
nindiv=20000
workdir <- '/Users/andrewmarderstein/Documents/Research/vQTL/ukb_vqtl/output/simulation/'
f <- paste0(workdir,'MAF1_',MAF1,'.MAF2_0.4.NSIM_1000.NINDIV_',nindiv,'.TYPE_gxg.NOISE_NORMAL.txt')
df[[2]] <- fread(f,data.table = F,stringsAsFactors = F)
df <- do.call(rbind,df)
df.aggre <- aggregate(.~MAF1+MAF2+N+noise+h+type,df,function(x) {mean(x < 0.05)})
df.aggre <- aggregate(.~MAF1+MAF2+N+noise+h+type,df,mean)
df.aggre
df.aggre <- aggregate(.~MAF1+MAF2+N+noise+h+type,df,function(x) {mean(x < 0.05)})
df.aggre
g <- ggplot(subset(df.aggre,h<=0.3),aes(h,N)) + geom_tile(aes(fill=DRM),col='white')
g
ggplot(subset(df.aggre,h<=0.03),aes(h,N)) + geom_tile(aes(fill=DRM),col='white') +
scale_fill_gradient(low = "white", high = "steelblue",name='Power')
e
ggplot(subset(df.aggre,h<=0.03),aes(h,N)) + geom_tile(aes(fill=DRM),col='white') +
scale_fill_gradient(low = "white", high = "steelblue",name='Power') +
theme_bw()  + theme(panel.grid = element_blank()) + #,legend.title = element_blank()) +
labs(x='Variance Explained by GxG',y='Sample Size')
ggplot(subset(df.aggre,h<=0.03),aes(h,N)) + geom_tile(aes(fill=DRM),col='white') +
scale_fill_gradient(low = "white", high = "steelblue",name='Power') +
theme_bw()  + theme(panel.grid = element_blank()) + #,legend.title = element_blank()) +
labs(x='Variance Explained by GxG',y='Sample Size') + scale_y_continuous(breaks=c(10000,20000))
mean(df.aggre$DRM)
df.aggre <- aggregate(.~MAF1+MAF2+N+noise+h+type,df,function(x) {mean(x < 0.05)})
mean(df.aggre$DRM)
mean(subset(df.aggre,N==10000)$DRM)
mean(subset(df.aggre,N==10000)$LT)
mean(subset(df.aggre,N==10000 & h <= 0.05)$DRM)
mean(subset(df.aggre,N==10000 & h <= 0.05)$LT)
mean(subset(df.aggre,N==10000 & h <= 0.05)$DRM) / mean(subset(df.aggre,N==10000 & h <= 0.05)$LT)

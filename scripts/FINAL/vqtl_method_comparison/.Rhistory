# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv,SNP,1+SNP*0.05)
# PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 50
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv,SNP,1+SNP*0.05)
# PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 50
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv,SNP,1+SNP*0.05)
# PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 50
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv,SNP,1+SNP*0.05)
# PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 50
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv,SNP,1+SNP*0.05)
# PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 50
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv,SNP,1+SNP*0.05)
# PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 50
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv,SNP,1+SNP*0.05)
# PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv,SNP,1+SNP*0.05)
# PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv,SNP,1+SNP*0.05)
# PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
PHENOTYPE <- rnorm(nindiv)
DeviationRegressionModel(PHENOTYPE,SNP)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
DeviationRegressionModel(tmp$Variance,tmp$SNP)
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
res.boot <- DeviationRegressionModel(tmp$Variance,tmp$SNP)
res.DRM <- DeviationRegressionModel(PHENOTYPE,SNP)
head(res.boot)
data.frame(beta.DRM=res.DRM[1],
p.DRM=res.DRM[2],
beta.boot=res.boot[1],
p.boot=res.boot[2])
# parameters
MAF1 <- 0.4
MAF2 <- 0.4
nindiv <- 10000
SNP <- rbinom(nindiv,2,MAF1)
DeviationRegressionModel <- function(PHENOTYPE,SNP) {
# Function to perform DRM test for vqtls
X <- as.factor(SNP)
Y.i <- tapply(PHENOTYPE, X, median)
Z.ij <- abs(PHENOTYPE - Y.i[X])
p <- as.numeric(summary(lm(Z.ij~SNP))$coef[2,c(1,4)])
return(p)
}
# PHENOTYPE <- rnorm(nindiv,SNP,1+SNP*0.05)
for (j in 1:10) {
print(j)
PHENOTYPE <- rnorm(nindiv)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
res.boot <- DeviationRegressionModel(tmp$Variance,tmp$SNP)
res.DRM <- DeviationRegressionModel(PHENOTYPE,SNP)
res.df.tmp <- data.frame(beta.DRM=res.DRM[1],
p.DRM=res.DRM[2],
beta.boot=res.boot[1],
p.boot=res.boot[2])
if (j==1) {
res.df.save <- res.df.tmp
} else {
res.df.save <- rbind(res.df.save,res.df.tmp)
}
}
res.df.save
# parameters
MAF1 <- 0.4
MAF2 <- 0.4
nindiv <- 10000
SNP <- rbinom(nindiv,2,MAF1)
DeviationRegressionModel <- function(PHENOTYPE,SNP) {
# Function to perform DRM test for vqtls
X <- as.factor(SNP)
Y.i <- tapply(PHENOTYPE, X, median)
Z.ij <- abs(PHENOTYPE - Y.i[X])
p <- as.numeric(summary(lm(Z.ij~SNP))$coef[2,c(1,4)])
return(p)
}
# PHENOTYPE <- rnorm(nindiv,SNP,1+SNP*0.05)
for (j in 1:10) {
print(j)
PHENOTYPE <- rnorm(nindiv)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
res.boot <- DeviationRegressionModel(tmp$Variance,tmp$SNP)
res.DRM <- DeviationRegressionModel(PHENOTYPE,SNP)
res.df.tmp <- data.frame(beta.DRM=res.DRM[1],
p.DRM=res.DRM[2],
beta.boot=res.boot[1],
p.boot=res.boot[2])
if (j==1) {
res.df.save <- res.df.tmp
} else {
res.df.save <- rbind(res.df.save,res.df.tmp)
}
}
res.df.save
print(j)
PHENOTYPE <- rnorm(nindiv)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
for (k in 1:n2sim) {
ind <- which(SNP==i)
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
res.boot <- DeviationRegressionModel(tmp$Variance,tmp$SNP)
res.DRM <- DeviationRegressionModel(PHENOTYPE,SNP)
res.df.tmp <- data.frame(beta.DRM=res.DRM[1],
p.DRM=res.DRM[2],
beta.boot=res.boot[1],
p.boot=res.boot[2])
res.df.tmp
res.boot
res.DRM
tmp$Variance
head(tmp$Variance)
dim(tmp$Variance)
length(tmp$Variance)
length(ind)
# PHENOTYPE <- rnorm(nindiv,SNP,1+SNP*0.05)
for (j in 1:10) {
print(j)
PHENOTYPE <- rnorm(nindiv)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
ind <- which(SNP==i)
for (k in 1:length(ind)) {
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=rep(0:2,each=n2sim),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
res.boot <- DeviationRegressionModel(tmp$Variance,tmp$SNP)
res.DRM <- DeviationRegressionModel(PHENOTYPE,SNP)
res.df.tmp <- data.frame(beta.DRM=res.DRM[1],
p.DRM=res.DRM[2],
beta.boot=res.boot[1],
p.boot=res.boot[2])
res.df.tmp
if (j==1) {
res.df.save <- res.df.tmp
} else {
res.df.save <- rbind(res.df.save,res.df.tmp)
}
}
k
i
table(SNP)
tmp <- data.frame(SNP=rep(0:2,each=table(SNP)),Variance=as.numeric(unlist(variance_list)))
table(SNP)
?tapply
?sapply
sapply(3:9,seq)
sapply(SNP,length)
aggregate(SNP,by=list(SNP),length)
tmp <- data.frame(SNP=rep(0:2,each=ggregate(SNP,by=list(SNP),length)[,2]),Variance=as.numeric(unlist(variance_list)))
tmp <- data.frame(SNP=rep(0:2,each=aggregate(SNP,by=list(SNP),length)[,2]),Variance=as.numeric(unlist(variance_list)))
aggregate(SNP,by=list(SNP),length)[,2]
tmp <- data.frame(SNP=rep(0:2,each=sort(SNP)),Variance=as.numeric(unlist(variance_list)))
tmp <- data.frame(SNP=sort(SNP),Variance=as.numeric(unlist(variance_list)))
tmp
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
res.boot <- DeviationRegressionModel(tmp$Variance,tmp$SNP)
res.DRM <- DeviationRegressionModel(PHENOTYPE,SNP)
res.df.tmp <- data.frame(beta.DRM=res.DRM[1],
p.DRM=res.DRM[2],
beta.boot=res.boot[1],
p.boot=res.boot[2])
res.df.tmp
# PHENOTYPE <- rnorm(nindiv,SNP,1+SNP*0.05)
for (j in 1:10) {
print(j)
PHENOTYPE <- rnorm(nindiv)
n2sim <- 1000
variance_list <- list()
variance_list[[as.character(0)]] <- rep(NA,n2sim)
for (i in 0:2) {
ind <- which(SNP==i)
for (k in 1:length(ind)) {
# PHENOTYPE.0 <- sample(PHENOTYPE[ind],length(ind),replace = T)
PHENOTYPE.0 <- sample(PHENOTYPE[ind],1000,replace = T)
variance_list[[as.character(i)]][k] <- var(PHENOTYPE.0)
}
}
tmp <- data.frame(SNP=sort(SNP),Variance=as.numeric(unlist(variance_list)))
# summary(lm(Variance~SNP,data=tmp))$coef[2,]
res.boot <- DeviationRegressionModel(tmp$Variance,tmp$SNP)
res.DRM <- DeviationRegressionModel(PHENOTYPE,SNP)
res.df.tmp <- data.frame(beta.DRM=res.DRM[1],
p.DRM=res.DRM[2],
beta.boot=res.boot[1],
p.boot=res.boot[2])
res.df.tmp
if (j==1) {
res.df.save <- res.df.tmp
} else {
res.df.save <- rbind(res.df.save,res.df.tmp)
}
}
res.df.save
head(tmp)
aggregate(tmp$Variance,by=list(tmp$SNP),variance)
aggregate(tmp$Variance,by=list(tmp$SNP),var)
aggregate(tmp$Variance,by=list(tmp$SNP),mean)
aggregate(tmp$Variance,by=list(tmp$SNP),mean)
